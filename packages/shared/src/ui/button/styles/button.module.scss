@import "@packages/sass/src/utilities/derived-variables";
@import "@packages/sass/src/utilities/initial-variables";
@import "./animation.scss";

$prefix: $class-prefix;
$transition-duration: 0.3s;

$btn-padding: (
    small: 4px 10px,
    medium: 8px 16px,
    large: 12px 20px
);

$btn-font-size: (
    small: $size-small,
    medium: $size-medium,
    large: $size-large
);

$btn-border-radius: 6px;
$btn-shadow-alpha-hover: 0.6;
$btn-shadow-alpha-text-hover: 0.1;
$btn-shadow-alpha-text-active: 0.2;

$btn-colors: (
    default: $scheme-main,
    primary: $primary,
    secondary: $secondary,
    success: $success,
    error: $danger,
    warning: $warning,
    info: $info
);

.#{$prefix}btn {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    border: none;
    border-radius: $btn-border-radius;
    font-weight: $weight-medium;
    font-family: $family-primary;
    cursor: pointer;
    user-select: none;
    transition:
        background-color $transition-duration ease,
        color $transition-duration ease,
        box-shadow $transition-duration ease,
        text-shadow $transition-duration ease;
    line-height: 1;
    gap: 8px;
    position: relative;

    &.#{$prefix}fullWidth {
        width: 100%;
    }

    &.#{$prefix}contained {
        background-color: $scheme-main;

        &:hover:not(.#{$prefix}disabled) {
            background-color: $scheme-main-bis;
        }

        &:active:not(.#{$prefix}disabled) {
            background-color: $scheme-main-ter;
            @include button-press-animation;
        }
    }

    &.#{$prefix}outlined {
        background-color: transparent;
        border: 1px solid currentColor;

        &:active:not(.#{$prefix}disabled) {
            box-shadow: none;
            text-shadow: none;
            @include button-press-animation;
        }
    }

    &.#{$prefix}text {
        background-color: transparent;
        border: none;

        &:hover:not(.#{$prefix}disabled) {
            background-color: $scheme-main-ter;
        }

        &:active:not(.#{$prefix}disabled) {
            background-color: $scheme-main-bis;
            @include button-press-animation;
        }
    }

    @each $colorName, $colorValue in $btn-colors {
        &.#{$colorName} {
            color: $colorValue;

            &.#{$prefix}outlined {
                border-color: $colorValue;
                color: $colorValue;

                &:hover:not(.#{$prefix}disabled) {
                    box-shadow: 0 0 4px rgba($colorValue, $btn-shadow-alpha-hover);
                    text-shadow: 0 0 2px rgba($colorValue, $btn-shadow-alpha-hover);
                }
            }

            &.#{$prefix}contained {
                background-color: $colorValue;
                color: $scheme-main;

                &:hover:not(.#{$prefix}disabled) {
                    background-color: lighten($colorValue, 5%);
                }

                &:active:not(.#{$prefix}disabled) {
                    background-color: darken($colorValue, 10%);
                    @include button-press-animation;
                }
            }

            &.#{$prefix}text {
                color: $colorValue;

                &:hover:not(.#{$prefix}disabled) {
                    background-color: rgba($colorValue, $btn-shadow-alpha-text-hover);
                }

                &:active:not(.#{$prefix}disabled) {
                    background-color: rgba($colorValue, $btn-shadow-alpha-text-active);
                    @include button-press-animation;
                }
            }
        }
    }

    &.#{$prefix}disabled {
        background-color: $scheme-main-ter;
        color: $text-weak;
        border-color: transparent;
        cursor: not-allowed;
        pointer-events: none;
        box-shadow: none;
        text-shadow: none;
    }

    @each $colorName, $colorValue in $btn-colors {
        &.#{$colorName}.#{$prefix}disabled {
            background-color: $scheme-main-ter;
            color: $text-weak;
            border-color: $scheme-main-ter;
        }
    }

    @each $sizeName, $padding in $btn-padding {
        &.#{$sizeName} {
            padding: $padding;
            font-size: map-get($btn-font-size, $sizeName);

            &.#{$prefix}outlined {
                $vertical: nth($padding, 1);
                $horizontal: nth($padding, 2);
                padding: ($vertical - 1px) ($horizontal - 1px);
            }
        }
    }

    .#{$prefix}label {
        visibility: visible;
        opacity: 1;
        transition: opacity $transition-duration ease;
    }

    &.#{$prefix}loading {
        pointer-events: none;

        .#{$prefix}label {
            opacity: 0;
        }

        &::before {
            @include loading-spinner(16px, currentColor);
            position: absolute;
            z-index: 1;
        }
    }

    .#{$prefix}icon {
        display: inline-flex;
        align-items: center;
        justify-content: center;

        &:first-child {
            margin-right: 4px;
        }

        &:last-child {
            margin-left: 4px;
        }
    }
}
